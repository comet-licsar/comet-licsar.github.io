<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced and specific use &mdash; COMET LiCSAR  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="COMET Members Information" href="cometmembers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            COMET LiCSAR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="wiki.html">LiCSAR Wiki (from gitlab)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main LiCSAR Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="licsar_db/index.html">LiCSInfo db</a></li>
<li class="toctree-l1"><a class="reference internal" href="licsar_proc/index.html">LiCSAR proc</a></li>
<li class="toctree-l1"><a class="reference internal" href="licsar_framebatch/index.html">LiCSAR Framebatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="daz/index.html">daz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="licsar_proc/apidoc.html">LiCSAR proc</a></li>
<li class="toctree-l1"><a class="reference internal" href="licsar_framebatch/apidoc.html">LiCSAR FrameBatch</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ciw.html">COMET InSAR Workshop Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cometmembers.html">COMET Members Information</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer comments and advices</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced and specific use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#manual-update-of-hires-volcano-time-series">Manual update of hires volcano time series</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#for-admins">For admins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#notes-about-documentation">Notes about documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#earthquake-responder">Earthquake Responder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i">How do I..</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clone-and-edit-the-docs">clone and edit the docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prepare-hi-res-frames">prepare hi res frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prepare-hi-res-subframes">prepare hi res subframes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#test">test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#this-is-section">this is section</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#h4">h4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#h5">h5</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COMET LiCSAR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Advanced and specific use</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/documentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="advanced-and-specific-use">
<h1>Advanced and specific use<a class="headerlink" href="#advanced-and-specific-use" title="Link to this heading"></a></h1>
<section id="manual-update-of-hires-volcano-time-series">
<h2>Manual update of hires volcano time series<a class="headerlink" href="#manual-update-of-hires-volcano-time-series" title="Link to this heading"></a></h2>
<p><strong>Processing steps:</strong></p>
<ol class="arabic simple">
<li><p>Identify volcano ID (e.g. on COMET Volcano Portal: <a class="reference external" href="https://comet.nerc.ac.uk/comet-volcano-portal/volcano-index/Search-All">https://comet.nerc.ac.uk/comet-volcano-portal/volcano-index/Search-All</a>  - the number after the volc name upon opening)</p></li>
<li><p>On any sciX.jasmin.ac.uk server, after loading LiCSAR env/module, run autoupdate LiCSAR procedure using:</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">volq_process.sh</span> <span class="pre">-L</span> <span class="pre">-v</span> <span class="pre">YOUR_VOLCANO_ID</span></code></p>
<p>This will check if there is any new unprocessed acquisition and request/download needed data and start LiCSAR processing (running in the background through LOTUS computing nodes) of all frames containing the volcano, ending in up-to-date data stored to the system.
This might finish in a day, check command <code class="docutils literal notranslate"><span class="pre">bjobs</span></code> to see status of processing jobs in LOTUS.
The general processing log file is in $BATCH_CACHE_DIR/VOLCLIP.frames.log.FRAME.
Data are automatically clipped to predefined high resolution subsets.</p>
<p>3. Once the data are on portal, you can proceed generating time series using LiCSBAS.
Same command but in time series regime (rather than -L for LiCSAR regime):</p>
<p><code class="docutils literal notranslate"><span class="pre">volq_process.sh</span> <span class="pre">-v</span> <span class="pre">YOUR_VOLCANO_ID</span></code></p>
<p>This will have LOTUS run up-to-date version of LiCSBAS with settings currently considered reliable (without experimental functionality)
on high resolution subsets for all related frames. By default, it will produce dense ifg network (Tien Shan strategy)
and unwrap by lics_unwrap.py (modified STAMPS-Goldstein filter-supported) and process to 30 m resolution datacube.</p>
<p>You should then find your results (and processing status) in your
$BATCH_CACHE_DIR/subsets/per_volcano/YOUR_VOLCANO_ID</p>
<p><strong>Some more details:</strong></p>
<p>Each volcano has its unique ID and is linked to at least one volcano clip definition (volclip) that is by default 25x25 km.
If you know your volclip, you can provide it instead of volcano ID, see <code class="docutils literal notranslate"><span class="pre">volq_process.sh</span></code> for help.
The operations over volcano database use functionality provided by volcdb python library (licsar_proc), e.g.
to find volcano ID based on name, you can try:</p>
<p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">volcdb;</span> <span class="pre">volcdb.find_volcano_by_name('ernandina')</span></code></p>
<p>The time series procedure (step 3) is copying clipped RSLCs to $BATCH_CACHE_DIR/subsets,
generates ifgs in extended network (with 3-,6-,12-months connections) and then unwraps them prior to LiCSBAS processing.
It will use existing (reunwrapped) interferograms if it finds them in expected path ($BATCH_CACHE_DIR/subsets).
However, the inversion itself (LiCSBAS) will run from the start (ongoing dev towards incremental updates).</p>
</section>
</section>
<section id="for-admins">
<h1>For admins<a class="headerlink" href="#for-admins" title="Link to this heading"></a></h1>
<section id="notes-about-documentation">
<h2>Notes about documentation<a class="headerlink" href="#notes-about-documentation" title="Link to this heading"></a></h2>
<p>The source files for this page are located at <a class="reference external" href="https://github.com/comet-licsar/comet-licsar.github.io">https://github.com/comet-licsar/comet-licsar.github.io</a></p>
<p>Documentation can be updated simply by editing the rst files in the ‘source’ folder.
After commit, github would auto-recreate web page of <a class="reference external" href="https://comet-licsar.github.io">https://comet-licsar.github.io</a> .</p>
</section>
<section id="earthquake-responder">
<h2>Earthquake Responder<a class="headerlink" href="#earthquake-responder" title="Link to this heading"></a></h2>
<p>This section will be moved to a better place. Now, only few comments:
1. the table for limits in selection of an EQ to process is:
::python</p>
<blockquote>
<div><p>from earthquake_responder import eq_limits; eq_limits</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>if the eq is below the thresholds, you can force-ingest it by adding its USGS ID to <code class="docutils literal notranslate"><span class="pre">$LiCSAR_public/EQ/exceptions.txt</span></code></p></li>
</ol>
</section>
<section id="how-do-i">
<h2>How do I..<a class="headerlink" href="#how-do-i" title="Link to this heading"></a></h2>
<section id="clone-and-edit-the-docs">
<h3>clone and edit the docs<a class="headerlink" href="#clone-and-edit-the-docs" title="Link to this heading"></a></h3>
<p>few steps are needed to clone and set the docs on your computer. first of all, you should set in github page, in Settings of your profile an up-to-date ssh key, formed with the email that is registered with your profile (you may add more emails in github profile settings, it works).</p>
<p>you may do e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">ed25519</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ed</span> <span class="o">-</span><span class="n">C</span> <span class="s2">&quot;YOURUSERNAME@leeds.ac.uk&quot;</span>
</pre></div>
</div>
<p>then edit your ~/.ssh/config to contain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Host</span> <span class="n">github</span><span class="o">.</span><span class="n">com</span>
  <span class="n">IdentityFile</span> <span class="o">~/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ed</span>
  <span class="n">IdentitiesOnly</span> <span class="n">yes</span>
</pre></div>
</div>
<p>Afterwards, you can just enter some directory and clone (and set) the repo there using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">comet</span><span class="o">-</span><span class="n">licsar</span><span class="o">/</span><span class="n">comet</span><span class="o">-</span><span class="n">licsar</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">comet</span><span class="o">-</span><span class="n">licsar</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span>
<span class="n">git</span> <span class="n">remote</span> <span class="nb">set</span><span class="o">-</span><span class="n">url</span> <span class="n">origin</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">comet</span><span class="o">-</span><span class="n">licsar</span><span class="o">/</span><span class="n">comet</span><span class="o">-</span><span class="n">licsar</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>ok, then you’re set and you can edit and push changes (if you are maintainer) as usual.</p>
</section>
<section id="prepare-hi-res-frames">
<h3>prepare hi res frames<a class="headerlink" href="#prepare-hi-res-frames" title="Link to this heading"></a></h3>
<p>say we have an AOI as e.g.</p>
<dl>
<dt>::</dt><dd><p>import framecare as fc
lat1,lon1 = 51.1, 15.7
lat2,lon2 = 51.8, 16.5</p>
<p># first get bursts over that AOI, e.g. as:
bursts = fc.lq.get_bursts_in_polygon(lon1,lon2,lat1,lat2)
bursts = fc.lq.sql2outlist(bursts)</p>
<p># now manually check the bursts and select only 1 relorb related..
bursts = ….</p>
<p># then generate high res frame with the AOI
fc.generate_new_frame(bursts, testonly=False, hicode=’H’)</p>
</dd>
</dl>
<p>Afterwards initialize the new frame with parameter -C, i.e.:</p>
<dl class="simple">
<dt>::</dt><dd><p>licsar_initialize_frame.sh -C 15.7/16.5/51.1/51.8 022A_0142H_000203</p>
</dd>
</dl>
</section>
<section id="prepare-hi-res-subframes">
<h3>prepare hi res subframes<a class="headerlink" href="#prepare-hi-res-subframes" title="Link to this heading"></a></h3>
<p>I know this sounds as duplicate - but it is not.
While the above commands would create new hires frame (that will be normally processed through licsar_make_frame.sh etc.),
it is often much better just to crop existing large frame, as this will ensure correct SD estimation, and generally decrease
doubled processing needs.</p>
<p>Now, this is finally prepared in the way that once you initialise such subset (as shown below),
the RSLCs will then automatically get updated/clipped once the frame is processed and you run <cite>store_to_curdir.sh</cite>.</p>
<p>The frame subsets will reside in $LiCSAR_procdir/subsets</p>
<p>Let me show the current approach through real example..</p>
<p>Due to earthquake near to SAREZ dam (!!!! a nightmare for middle East for the last 100 years), John Elliott requested hires frames.
He defined the region as (lons/lats): 72.510/72.845/38.130/38.365.
Thus, let’s get frames and initialise their subsets using:</p>
<dl>
<dt>::</dt><dd><p>import framecare as fc
frames=fc.lq.get_frames_in_lonlat(72.7,38.2)
# returns: ((‘005D_05199_131313’,), (‘100A_05236_141313’,))
for frame in frames:</p>
<blockquote>
<div><p>fc.subset_initialise_corners(frame, 72.510, 72.845, 38.130, 38.365, ‘SAREZ’)</p>
</div></blockquote>
</dd>
</dl>
<p>and that’s it. Now you may proceed just to process the frames as usual.
Note that this will not generate interferograms. But this can be done simply by running <cite>framebatch_gapfill.sh</cite>
(more instructions later, or ask Lin Shen for advice).</p>
<p>If this is only one-off procedure (no need to store in <cite>subsets</cite> folder), you may also just
run in their <cite>$BATCH_CACHE_DIR/$frame</cite> following command that will also generate interferograms:</p>
<dl class="simple">
<dt>::</dt><dd><p>clip_slc.sh SAREZ_005D 72.510 72.845 38.130 38.365 0 0.00027 1</p>
</dd>
</dl>
</section>
</section>
<section id="test">
<h2>test<a class="headerlink" href="#test" title="Link to this heading"></a></h2>
<section id="this-is-section">
<h3>this is section<a class="headerlink" href="#this-is-section" title="Link to this heading"></a></h3>
<p><cite>this is quoted text</cite></p>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h4>
<p>Some example of Sphinx generated documentation</p>
<ul class="simple">
<li><p>bullet 1</p></li>
<li><p>bullet 2</p></li>
</ul>
<p>link to <a href="#id5"><span class="problematic" id="id6">`Sphinx Examples`_</span></a></p>
<p>ok, now this is from RSTPAD:</p>
<section id="h1">
<h5>h1<a class="headerlink" href="#h1" title="Link to this heading"></a></h5>
<section id="h2">
<h6>h2<a class="headerlink" href="#h2" title="Link to this heading"></a></h6>
<p># h3
# ==</p>
</section>
</section>
</section>
</section>
</section>
<section id="h4">
<h2>h4<a class="headerlink" href="#h4" title="Link to this heading"></a></h2>
<section id="h5">
<h3>h5<a class="headerlink" href="#h5" title="Link to this heading"></a></h3>
<p><strong>bold</strong>
<em>italic</em>
- list
#. numlist
something</p>
<p>s —- thing</p>
<blockquote>
<div><p>tab</p>
</div></blockquote>
<p><a class="reference external" href="http://example.com/">link</a>
.. image:: image
inline <a href="#id1"><span class="problematic" id="id2">``</span></a>code is <a href="#id3"><span class="problematic" id="id4">``</span></a>this</p>
<p>code block</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ow">is</span>
<span class="n">this</span> <span class="n">block</span>
<span class="ow">is</span> <span class="n">this</span>
</pre></div>
</div>
<p>highlighted</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">block</span>
<span class="n">of</span>
<span class="n">code</span>
<span class="ow">is</span>
<span class="n">this</span>
</pre></div>
</div>
<p>tralala</p>
<p>The library can also be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">sphinx</span>
</pre></div>
</div>
<p>The rst format was developed for writing documentation. There are numerous markup options available such as using asterisks to emphasise text:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">emphasised</span> <span class="n">text</span><span class="o">*</span>
</pre></div>
</div>
<p>will be rendered as:</p>
<p><em>emphasised text</em></p>
<p>code example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function_a</span><span class="p">(</span><span class="n">arg_a</span><span class="p">,</span> <span class="n">arg_b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is function a, which adds two values</span>

<span class="sd">    :param arg_a: first argument is a ``float``</span>
<span class="sd">    :param arg_b: second argument in an ``int``</span>
<span class="sd">    :return: arg_a + arg_b</span>

<span class="sd">    Example usage::</span>

<span class="sd">      &gt;&gt;&gt; from python_library import function_a</span>
<span class="sd">      &gt;&gt;&gt; function_a(2, 3)</span>
<span class="sd">      5</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">arg_a</span> <span class="o">+</span> <span class="n">arg_b</span>
</pre></div>
</div>
<p>This will produce documentation which renders as:</p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">python_library.</span></span><span class="sig-name descname"><span class="pre">function_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg_b</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>This is function a, which adds two values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg_a</strong> – first argument is a <code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><strong>arg_b</strong> – second argument in an <code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>arg_a + arg_b</p>
</dd>
</dl>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">python_library</span> <span class="kn">import</span> <span class="n">function_a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">function_a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<p>To include autogenerated documentation, there are various methods available (see the <a href="#id7"><span class="problematic" id="id8">`Sphinx Autodoc Documentation`_</span></a>), for example, to include documentation for all members of the Python library <code class="docutils literal notranslate"><span class="pre">python_library</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">automodule</span><span class="p">::</span> <span class="n">python_library</span>
    <span class="p">:</span><span class="n">members</span><span class="p">:</span>
</pre></div>
</div>
<p>this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ make
Sphinx v4.4.0
Please use `make target&#39; where target is one of
  html        to make standalone HTML files
  dirhtml     to make HTML files named index.html in directories
  singlehtml  to make a single large HTML file
...
</pre></div>
</div>
<p>For example, to build HTML documentation, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cometmembers.html" class="btn btn-neutral float-left" title="COMET Members Information" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, COMET and CEMAC teams.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>